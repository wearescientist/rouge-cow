# v0.7.2 设计文档 - 武器进化系统

## 1. 功能概述

### 1.1 武器进化概念
武器可以通过收集材料进行进化，每次进化提升武器等级，解锁新的能力或增强现有属性。

### 1.2 进化树设计
每种武器有独立的进化路线，玩家可以根据战斗风格选择不同的进化方向。

## 2. 武器进化树

### 2.1 鞭子进化路线
```
鞭子 (Lv.1)
  ├── 火焰鞭 (Lv.2) - 附加火焰伤害
  │     └── 地狱鞭 (Lv.3) - 火焰范围伤害
  ├── 雷电鞭 (Lv.2) - 附加雷电伤害+麻痹
  │     └── 雷神鞭 (Lv.3) - 连锁雷电
  └── 荆棘鞭 (Lv.2) - 附加流血效果
        └── 血藤鞭 (Lv.3) - 吸血效果
```

### 2.2 魔杖进化路线
```
魔杖 (Lv.1)
  ├── 冰霜魔杖 (Lv.2) - 减速效果
  │     └── 绝对零度 (Lv.3) - 冰冻效果
  ├── 奥数魔杖 (Lv.2) - 穿透+1
  │     └── 虚空魔杖 (Lv.3) - 无限穿透
  └── 生命魔杖 (Lv.2) - 治疗波
        └── 圣光魔杖 (Lv.3) - 群体治疗
```

### 2.3 飞刀进化路线
```
飞刀 (Lv.1)
  ├── 毒刃 (Lv.2) - 中毒效果
  │     └── 瘟疫之刃 (Lv.3) - 传染中毒
  ├── 回旋镖 (Lv.2) - 返回伤害
  │     └── 风暴飞刃 (Lv.3) - 多段返回
  └── 暗影飞刀 (Lv.2) - 暴击率提升
        └── 死亡之刃 (Lv.3) - 即死效果
```

### 2.4 斧头进化路线
```
斧头 (Lv.1)
  ├── 战斧 (Lv.2) - 伤害提升
  │     └── 巨神斧 (Lv.3) - 范围攻击
  ├── 投掷斧 (Lv.2) - 可投掷
  │     └── 风暴战斧 (Lv.3) - 分裂攻击
  └── 诅咒斧 (Lv.2) - 削弱敌人
        └── 末日斧 (Lv.3) - 恐惧效果
```

## 3. 进化材料系统

### 3.1 材料类型
| 材料 | 图标 | 掉落来源 | 用途 |
|------|------|----------|------|
| 火焰精华 | 🔥 | 火焰敌人 | 火焰系进化 |
| 冰霜结晶 | ❄️ | 冰霜敌人 | 冰霜系进化 |
| 雷电核心 | ⚡ | 雷电敌人 | 雷电系进化 |
| 暗影碎片 | 🌑 | 暗影敌人 | 暗影系进化 |
| 生命精华 | 🌿 | 植物敌人 | 生命系进化 |
| 钢铁碎片 | 🔩 | 机械敌人 | 物理系进化 |
| 魔法粉尘 | ✨ | 魔法敌人 | 通用进化 |
| 远古遗物 | 🏺 | BOSS | 高级进化 |

### 3.2 材料掉落
- 普通敌人：10%掉落材料
- 精英敌人：30%掉落材料
- BOSS：100%掉落远古遗物

## 4. UI设计

### 4.1 武器进化界面
- 按V键打开武器进化界面
- 显示当前武器和可选进化路线
- 显示所需材料
- 点击进化按钮进行进化

### 4.2 材料栏
- 显示当前拥有的材料数量
- 在武器进化界面显示材料是否足够

## 5. 代码实现

### 5.1 新增数据结构
```javascript
// 武器进化配置
const WEAPON_EVOLUTIONS = {
    whip: {
        fire: { name: '火焰鞭', icon: '🔥', req: { fire: 3 }, bonus: { fireDmg: 5 } },
        thunder: { name: '雷电鞭', icon: '⚡', req: { thunder: 3 }, bonus: { thunderDmg: 5 } },
        thorn: { name: '荆棘鞭', icon: '🌿', req: { life: 3 }, bonus: { lifeSteal: 0.05 } }
    },
    // ...
};

// 材料系统
const MATERIALS = {
    fire: { name: '火焰精华', icon: '🔥' },
    ice: { name: '冰霜结晶', icon: '❄️' },
    thunder: { name: '雷电核心', icon: '⚡' },
    // ...
};
```

### 5.2 新增类
- `MaterialManager` - 材料管理器
- `WeaponEvolutionUI` - 武器进化UI

## 6. 与故事大纲的契合

- 武器进化体现牛牛在地底冒险中的成长
- 材料收集对应击败不同敌人获得的力量
- 进化路线多样化，体现玩家的选择

## 7. 测试计划

1. 击败敌人收集材料
2. 打开武器进化界面
3. 选择进化路线
4. 确认材料消耗和武器升级
5. 测试新武器效果
6. 录制测试视频
