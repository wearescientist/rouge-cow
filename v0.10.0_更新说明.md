# 肉鸽牛牛 v0.10.0 更新说明

## 🆕 新增功能

### 1. 自适应视野（完整房间显示）
- **问题**: 原来只能看到 1/9 的房间（900x600 视野 vs 2700x1800 房间）
- **解决**: 新增自适应视野系统
  - 屏幕足够大时（比房间大100px边距），自动显示完整房间
  - 屏幕不够大时，显示尽可能大的视野
  - 支持缩放调整

### 2. 角色阴影重制
- **问题**: 原来的阴影是一个奇怪的椭圆
- **解决**: 改为用脚伸缩模拟阴影效果
  - 行走时腿部交替伸缩
  - 腿部接触地面时产生动态阴影
  - 站立时双脚着地，阴影更明显

### 3. 地形遮挡门修复
- **问题**: 某些房间模板的地形会遮挡门
- **解决**: 
  - 绘制时自动跳过遮挡门区域的障碍物
  - 门始终在障碍物之上绘制
  - 门区域：上/下门（中心±30px），左/右门（中心±40px）

### 4. 全新UI布局（两侧显示区域）
```
┌─────────────────────────────────────────────────────────────┐
│ [左侧面板]          [游戏画面]              [右侧面板]     │
│                                                                        │
│  🐮 角色状态          2700x1800              🗺️ 地图       │
│  ❤️ 生命 6/6            房间画面             [小地图]       │
│  ⭐ 等级 Lv.1                               🎒 道具       │
│  💰 金币 100                                [16格背包]     │
│  ⚔️ 武器 1                                  📊 统计       │
│                                              击杀: 0       │
│  🔫 装备武器                                 探索: 0       │
│  [武器列表]                                                │
│                                                                        │
└─────────────────────────────────────────────────────────────┘
        [层数指示器: 第 1 / 6 层]
        [分数面板: 8,450 | 连杀x5]
```

**左侧面板**: 角色状态、武器列表
**右侧面板**: 小地图、道具背包、本局统计
**顶部中央**: 分数面板（已移至中间更醒目）
**底部中央**: 层数指示器

## 🎮 游戏界面变化

### 旧界面
- 分数面板在右上角
- 所有UI叠加在游戏画面上
- 视野受限只能看到部分房间

### 新界面
- 分数面板移至顶部中央
- 两侧独立面板显示详细信息
- 全屏时显示完整房间
- 小地图实时显示探索进度

## 🎯 技术细节

### SurvivorCamera 类更新
```javascript
// 新增自适应视野
updateViewport() {
    // 屏幕够大时显示完整房间
    // 屏幕不够大时使用缩放
}
```

### 绘制顺序调整
1. 地板
2. 房间边界（厚墙）
3. 门区域保护（挖洞）
4. 障碍物（跳过门区域）
5. 门（在所有障碍物之上）
6. 角色、敌人、道具等

### UI系统重构
- 使用 HTML + CSS 叠加层
- 实时更新角色状态
- 小地图使用 Canvas 绘制
- 道具格子动态显示

## 🐛 修复的Bug
1. ✅ 视野太小，只能看到部分房间
2. ✅ 角色阴影显示异常
3. ✅ 地形遮挡门无法通过
4. ✅ UI信息堆叠在画面上影响观感

## 📝 使用说明
- 按 `F` 进入全屏，屏幕够大时自动显示完整房间
- 两侧面板在游戏开始后自动显示
- 小地图实时更新，黄色高亮当前房间
- 分数面板移至顶部中央更易查看
